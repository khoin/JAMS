<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="pixi.min.js"></script>
	<style>
		html, body {
			margin: 0; padding: 0; box-sizing: border-box; 
			width: 100%; height: 100%; overflow: hidden;
			background: #012;
		}
	</style>
</head>
<body>
</body>
<script>

var number = (function(f) {
	var _ = this,
		f = f;

	this.run = function() {
		return f;
	} 
})

var sinOscillator = (function(f) {
	var _ = this;
	var PM = null,
		 f = f || 440;
		this.lastSample = 0;

	this.getInfo = function() {
		return {
			AM: AM,
			PM: PM,
			f: f
		};
	}

	this.setInput = function(node) {
		PM  = node;
	}

	this.run = function(t,z) {
		if(z == 1) return _.lastSample;
		var pm = (PM)? PM.run(t,1):0;
		_.lastSample = Math.sin(Math.PI*2*f*t + Math.PI*2*pm);
		return _.lastSample;
	} 

	this.connect = function(node) {
		node.setInput(_);
	}

	return this;
});

var aC = new AudioContext();
var node = aC.createScriptProcessor(4096, 0, 1);

var t = 0;

var asc = new sinOscillator(6),
    bsc = new sinOscillator(220);
var osc = new sinOscillator(440);

//asc.input(bsc);
asc.connect(osc);
bsc.connect(asc);

var dsp = function(t) {
	asc.run(t); bsc.run(t);
	return 0.2* osc.run(t);
}

node.connect(aC.destination);
node.onaudioprocess = function(audioProcessingEvent) {
	var obuffer = audioProcessingEvent.outputBuffer;
	for( var ch=0; ch < obuffer.numberOfChannels; ch++ ){
		var odata = obuffer.getChannelData(ch);
		for(var i=0; i<obuffer.length; i++) {
			odata[i] = dsp(t + (i/aC.sampleRate) );
		}
	}
	t += obuffer.length/aC.sampleRate;
}


</script>
</html>